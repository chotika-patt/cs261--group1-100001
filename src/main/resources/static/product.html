<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | TU Store</title>
</head>

<body>
  <!-- ======= Navbar ‡∏ö‡∏ô‡∏™‡∏∏‡∏î ======= -->
  <nav class="nav-top">
    <div class="right-buttons">
      <a href="login.html" class="btn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
      <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
    </div>
  </nav>

  <!-- ======= Navbar ‡∏•‡πà‡∏≤‡∏á ======= -->
  <nav class="nav-bottom">
    <ul class="menu">
      <li>
        <a href="index.html"><img class="logo" src="img/Emblem_of_Thammasat_University.svg.png" alt="TU Logo"></a>
      </li>
      <li><a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
      <li class="dropdown-category">
        <a href="#" class="dropdown-toggle">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <i class="fa-solid fa-chevron-down"></i></a>
        <div class="overlay"></div>
        <div class="dropdown-content">
          <a href="#">‡πÄ‡∏™‡∏∑‡πâ‡∏≠</a>
          <a href="#">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</a>
          <a href="#">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</a>
          <a href="#">‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</a>
          <a href="#">‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</a>
        </div>
      </li>
      <li><a href="#">‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</a></li>
      <li><a href="#">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
      <li><a href="#" id="search-icon"><i class="fa-solid fa-magnifying-glass"></i></a></li>
    </ul>

    <!-- ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <div class="search-bar-replacement">
      <div class="search-input-container">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£...">
      </div>
      <button class="search-close-btn" id="search-close">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
  </nav>

  <!-- ======= ‡πÅ‡∏ñ‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ======= -->
  <div class="category-bar">
    <div class="category-header" onclick="toggleCategoryDropdown()">
      <a class="category-toggle"><span>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <i class="fa-solid fa-chevron-down"></i></span></a>
    </div>

    <div class="category-dropdown">
      <div class="category-con">
        <div class="category-item">
          <div class="category-box">
            <img src="img/jersey.png" alt="‡πÄ‡∏™‡∏∑‡πâ‡∏≠">
          </div>
          <h3>‡πÄ‡∏™‡∏∑‡πâ‡∏≠</h3>
        </div>
        <div class="category-item">
          <div class="category-box">
            <img src="img/bag.png" alt="‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤">
          </div>
          <h3>‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</h3>
        </div>
        <div class="category-item">
          <div class="category-box">
            <img src="img/uniform.png" alt="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤">
          </div>
          <h3>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h3>
        </div>
        <div class="category-item">
          <div class="category-box">
            <img src="img/things.png" alt="‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">
          </div>
          <h3>‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3>
        </div>
        <div class="category-item">
          <div class="category-box">
            <img src="img/arttoy.png" alt="‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å">
          </div>
          <h3>‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- ======= ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ======= -->
  <div class="product-section">
    <div style="display: flex; align-items: baseline; justify-content: space-between;">
      <h1 style="margin: 0;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
    </div>
    <br>

    <!-- ‚úÖ ‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡πÉ‡∏´‡πâ JS ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏≠‡∏á -->
    <div class="product-grid">
      <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏ö‡∏ö Dynamic -->
    </div>
  </div>

  <!-- ======= Script ‡∏™‡πà‡∏ß‡∏ô Navbar ‡πÅ‡∏•‡∏∞ Category ======= -->
  <script>
    // ===== ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ =====
    const searchIcon = document.getElementById('search-icon');
    const searchClose = document.getElementById('search-close');
    const navBottom = document.querySelector('.nav-bottom');

    searchIcon.addEventListener('click', (event) => {
      event.preventDefault();
      navBottom.classList.add('search-active');
    });

    searchClose.addEventListener('click', () => {
      navBottom.classList.remove('search-active');
    });

    // ===== Dropdown ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà =====
    const toggle = document.querySelector('.dropdown-toggle');
    const dropdownContent = document.querySelector('.dropdown-content');
    const overlay = document.querySelector('.overlay');

    if (toggle && dropdownContent && overlay) {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        const isOpen = dropdownContent.style.display === 'block';
        dropdownContent.style.display = isOpen ? 'none' : 'block';
        overlay.style.display = isOpen ? 'none' : 'block';
      });

      overlay.addEventListener('click', function() {
        dropdownContent.style.display = 'none';
        overlay.style.display = 'none';
      });
    }

    // ===== Toggle Category Bar =====
    function toggleCategoryDropdown() {
      const bar = document.querySelector('.category-bar');
      const categoryDropdown = document.querySelector('.category-dropdown');
      if (bar && categoryDropdown) {
        categoryDropdown.classList.toggle('show');
        bar.classList.toggle('active');
      }
    }
  </script>

  <!-- ======= Script ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ö‡∏ö Dynamic ======= -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const productGrid = document.querySelector(".product-grid");
      productGrid.innerHTML = "<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</p>";

      fetch("http://localhost:8080/api/products")
        .then(response => {
          if (!response.ok) throw new Error("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
          return response.json();
        })
        .then(products => {
          productGrid.innerHTML = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

          if (!products || products.length === 0) {
            productGrid.innerHTML = `
              <p style="text-align:center; font-size:18px; width:100%;">
                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
              </p>`;
            return;
          }

          // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
          products.forEach(product => {
            const card = document.createElement("div");
            card.classList.add("product-card");

            card.innerHTML = `
              <div class="product-image">
                <img src="${product.imageUrl || 'img/placeholder.png'}" alt="${product.name}">
              </div>
              <div class="product-info">
                <span class="product-name">${product.name}</span>
                <span class="product-price">‡∏ø ${product.price ? product.price.toFixed(2) : '0.00'}</span>
              </div>
            `;

            productGrid.appendChild(card);
          });
        })
        .catch(error => {
          console.error("Error:", error);
          productGrid.innerHTML = `
            <p style="text-align:center; color:red;">
              ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            </p>`;
        });
    });
  </script>

  <script>
document.addEventListener("DOMContentLoaded", () => {
  const productGrid = document.querySelector(".product-grid");
  productGrid.innerHTML = "<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</p>";

  // üîç ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å URL
  const urlParams = new URLSearchParams(window.location.search);
  const searchQuery = urlParams.get('search');
  const categoryQuery = urlParams.get('category');

  // ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å backend
  let apiUrl = "http://localhost:8080/api/products";

  if (searchQuery) {
    apiUrl += `?name=${encodeURIComponent(searchQuery)}`;
  } else if (categoryQuery) {
    apiUrl += `?category=${encodeURIComponent(categoryQuery)}`;
  }

  fetch(apiUrl)
    .then(response => {
      if (!response.ok) throw new Error("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      return response.json();
    })
    .then(products => {
      productGrid.innerHTML = "";

      if (!products || products.length === 0) {
        productGrid.innerHTML = `
          <p style="text-align:center; font-size:18px; width:100%;">
            ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
          </p>`;
        return;
      }

      products.forEach(product => {
        const card = document.createElement("div");
        card.classList.add("product-card");

        card.innerHTML = `
          <div class="product-image">
            <img src="${product.imageUrl || 'img/placeholder.png'}" alt="${product.name}">
          </div>
          <div class="product-info">
            <span class="product-name">${product.name}</span>
            <span class="product-price">‡∏ø ${product.price ? product.price.toFixed(2) : '0.00'}</span>
          </div>
        `;

        productGrid.appendChild(card);
      });
    })
    .catch(error => {
      console.error("Error:", error);
      productGrid.innerHTML = `
        <p style="text-align:center; color:red;">
          ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        </p>`;
    });
});
</script>

  <script>
      document.addEventListener("DOMContentLoaded", function() {
        const params = new URLSearchParams(window.location.search);
        const categoryName = params.get("category");

        let apiUrl = "http://localhost:8080/api/products";
        if (categoryName) {
          apiUrl += `?name=&categoryName=${encodeURIComponent(categoryName)}`;
        }

        fetch(apiUrl)
          .then(response => response.json())
          .then(products => {
            const grid = document.querySelector(".product-grid");
            grid.innerHTML = "";

            if (!products || products.length === 0) {
              grid.innerHTML = `<p style="text-align:center;width:100%;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>`;
              return;
            }

            products.forEach(p => {
              const card = `
                <div class="product-card">
                  <div class="product-image">
                    <img src="${p.main_image || 'img/placeholder.png'}" alt="${p.name}">
                  </div>
                  <div class="product-info">
                    <span class="product-name">${p.name}</span>
                    <span class="product-price">‡∏ø ${p.price}</span>
                  </div>
                </div>
              `;
              grid.insertAdjacentHTML("beforeend", card);
            });
          })
          .catch(err => {
            console.error("Error fetching products:", err);
            document.querySelector(".product-grid").innerHTML =
              `<p style="text-align:center;width:100%;">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ</p>`;
          });
      });
  </script>



</body>
</html>
